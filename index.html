<!DOCTYPE html>
<html lang="en">

<head>
  <script>
    (function () {
      // Check if the current URL contains "github"
      if (!window.location.href.includes("github")) {
        // Helper function to modify and reload elements with cache busting
        function reloadElementWithCacheBust(element, attribute) {
          let attrValue = element.getAttribute(attribute);
          if (attrValue && attrValue.includes("/learningwithwick")) {
            // Replace '/learningwithwick' with an empty string
            let newAttrValue = attrValue.replace("/learningwithwick", "");

            // Add cache-busting parameter to force reload
            const cacheBustParam = `?cb=${new Date().getTime()}`;
            const updatedAttrValue = newAttrValue.includes("?")
              ? newAttrValue + "&" + cacheBustParam
              : newAttrValue + cacheBustParam;

            element.setAttribute(attribute, updatedAttrValue);

            // For script tags, we need to re-inject them to execute again
            if (element.tagName.toLowerCase() === "script") {
              const clone = document.createElement("script");
              clone.src = updatedAttrValue;
              clone.async = element.async;
              clone.defer = element.defer;
              element.parentNode.replaceChild(clone, element);
            }
          }
        }

        // Modify link and script tags in the head (stylesheets, JS)
        const headElements = document.querySelectorAll('link[href], script[src]');
        headElements.forEach(element => {
          if (element.hasAttribute('href')) {
            reloadElementWithCacheBust(element, 'href');
          }
          if (element.hasAttribute('src')) {
            reloadElementWithCacheBust(element, 'src');
          }
        });

        // After DOM content is loaded, modify other body elements (images, iframes, etc.)
        document.addEventListener('DOMContentLoaded', function () {
          const bodyElements = document.querySelectorAll('[src], [href], [id]');
          bodyElements.forEach(element => {
            if (element.hasAttribute('src')) {
              reloadElementWithCacheBust(element, 'src');
            }
            if (element.hasAttribute('href')) {
              reloadElementWithCacheBust(element, 'href');
            }
            if (element.hasAttribute('id')) {
              reloadElementWithCacheBust(element, 'id');
            }
          });
        });

        console.log("Paths modified and resources reloaded with cache-busting for GitHub Pages");
      }
    })();
  </script>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard - Wick Learning</title>
  <link rel='icon' type='image/x-icon' href='/learningwithwick/media/logo.png'>
  <link rel="stylesheet" href="/learningwithwick/style.css">
  <link rel="stylesheet" href="/learningwithwick/styles/onboarding.css">
  <link rel="stylesheet" href="/learningwithwick/styles/sidebar.css">
  <script src="https://kit.fontawesome.com/0303383be9.js" crossorigin="anonymous"></script>
</head>

<body>
  <div class='loading-overlay' id='loading-overlay'></div>

  <div class='modal-container'>
    <div class='modal onboarding-username'>
      <!--Title-->
      <div class='text-container'>
        <h1>
          ðŸ‘‹ Hey! Welcome to Wick Learning!
        </h1>
        <h2>
          We're so happy to have you!<br>To begin, please create a username!
        </h2>
      </div>
      
      <div class='input-container'>
        <input type='text' id='input' required='' maxlength='20'>
        <label for='input' class='label'>Enter Username</label>
        <div class='underline'></div>
        <button id='submit-username'>
          Create Username
        </button>
      </div>
    </div>
  
    <div class='modal onboarding-pfp current_inactive'>
      <div class='text-container'>
        <h1>
          ðŸ“Œ Select a Profile Picture!
        </h1>
        <h2>
          Choose the one you love most!<br>You always have the option to change it later!
        </h2>
      </div>

      <div class='input-container pfps'>
        <img src='/learningwithwick/media/pfps/Corgi.jpg' id='pfp_/learningwithwick/media/pfps/Corgi.jpg'>
        <img src='/learningwithwick/media/pfps/CupidsTeddy.jpg' id='pfp_/learningwithwick/media/pfps/CupidsTeddy.jpg'>
        <img src='/learningwithwick/media/pfps/Giraffe.jpg' id='pfp_/learningwithwick/media/pfps/Giraffe.jpg'>
        <img src='/learningwithwick/media/pfps/Dragon.jpg' id='pfp_/learningwithwick/media/pfps/Dragon.jpg'>
        <img src='/learningwithwick/media/pfps/Ladybug.jpg' id='pfp_/learningwithwick/media/pfps/Ladybug.jpg'>
        <img src='/learningwithwick/media/pfps/Owl.jpg' id='pfp_/learningwithwick/media/pfps/Owl.jpg'>
        <img src='/learningwithwick/media/pfps/Triceratops.jpg' id='pfp_/learningwithwick/media/pfps/Triceratops.jpg'>
        <img src='/learningwithwick/media/pfps/Bee.jpg' id='pfp_/learningwithwick/media/pfps/Bee.jpg'>
      </div>

      <button id='quit-modal'>
        Let's Go!
      </button>
    </div>
  </div>

  <div class='main-container'>

    <h4 class='welcome-back-text'>
      Welcome Back,
    </h4>

    <h1 class='welcome-back-name data-username' id='welcome-back-name'>
      OnlyTwentyCharacters!
    </h1>

    <div class='last-played' id='last-played'>
      <h1>
        Recently Played:
        </h2>

        <h2>
          Chapter 1 Quiz
        </h2>

        <button class='last-played-button' id='/learningwithwick/practice/games/chapter/1/quiz/'>
          <i class='fas fa-play'></i>
          Play Now
        </button>

        <i class='fa-solid fa-id-card' id='ico'></i>
    </div>

  </div>

  <div class='sidebar'>
    <div class='sidebar-logo'>
      <img class='logo' src='/learningwithwick/media/logo.png'>
      <h1>Wick</h1>
    </div>

    <div class='sidebar-buttons-container' id='sidebar-buttons-container'>
      <button class='sidebar-button current' id='/learningwithwick/'>
        <i class="fa-regular fa-map"></i>
        Home
      </button>

      <button class='sidebar-button' id='/learningwithwick/practice/games' style='background-color: transparent;'>
        <i class="fa-regular fa-flag"></i>
        Practice
      </button>

      <button class='sidebar-button' id='/learningwithwick/statistics/' style='background-color: transparent;'>
        <i class="fa-regular fa-chart-bar"></i>
        Statistics
      </button>

      <button class='sidebar-button' style='background-color: transparent;'>
        <i class='fa-classic fa-calendar'></i>
        Schedule
      </button>

      <button class='sidebar-button' style='background-color: transparent;'>
        <i class="fa-regular fa-pen-to-square"></i>
        Settings
      </button>

      <div class='sidebar-bottom'>
        <h4>
          Have any problems with Learning with Wick? Contact our customer support!
        </h4>

        <button id='support-button'>
          Contact Us
        </button>
      </div>
    </div>
  </div>

  <div class='profile-sidebar'>
    <div class='profile-top-container'>
      <img class='profile-picture'>
      <h3>Hey,</h3>
      <h1 class='data-username'>OnlyTwentyCharacters!</h1>
    </div>
    <div class='profile-content-container'>

      <div class='box animate-on-load'>
        <div class='flex-box'>
          <div class='box-image box-1'>
            <i class="fa-solid fa-book"></i>
          </div>
          <div class='box-text'>
            <h2>
              Total Quizzes
            </h2>
            <h3>
              N/A
            </h3>
          </div>
        </div>
      </div>

      <div class='box animate-on-load'>
        <div class='flex-box'>
          <div class='box-image box-2'>
            <i class="fa-solid fa-chart-pie"></i>
          </div>
          <div class='box-text'>
            <h2>
              Practice Average
            </h2>
            <h3>
              N/A
            </h3>
          </div>
        </div>
      </div>

      <div class='box animate-on-load'>
        <div class='flex-box'>
          <div class='box-image box-3'>
            <i class="fa-solid fa-bookmark"></i>
          </div>
          <div class='box-text'>
            <h2>
              Best Chapter
            </h2>
            <h3>
              N/A
            </h3>
          </div>
        </div>
      </div>

    </div>
    <div class='profile-bottom-container'>
      <div class='bottom-button animate-on-load' id='/learningwithwick/practice/games/'>
        <i class="fa-regular fa-flag"></i>
      </div>
      <div class='bottom-button animate-on-load' id='/learningwithwick/statistics/'>
        <i class="fa-regular fa-chart-bar"></i>
      </div>
      <div class='bottom-button animate-on-load'>
        <i class='fa-regular fa-calendar'></i>
      </div>
      <div class='bottom-button animate-on-load'>
        <i class="fa-regular fa-pen-to-square"></i>
      </div>
    </div>
  </div>

  <script src='/learningwithwick/scripts/loading.js'></script>
  <script src='/learningwithwick/script.js'></script>
  <script>
    let dataset = ['fa-solid fa-id-card', 'fa-solid fa-helmet-safety', 'fa-solid fa-traffic-light', 'fa-solid fa-gauge'];
    let lPlayed = localStorage.getItem('last-played');
    let icon = (lPlayed !== null) ? dataset[(lPlayed - 1)] : dataset[0];
    document.getElementById('ico').className = icon;
    if (localStorage.getItem('last-played')) {
      document.querySelector('.last-played > h2').textContent = `Chapter ${lPlayed} Quiz`;
      lPlayed = `/learningwithwick/practice/games/chapter/${lPlayed}/quiz/`;
    } else {
      document.querySelector('.last-played > h1').textContent = 'We Recommend:';
      document.querySelector('.last-played > h2').textContent = `Chapter ${1} Quiz`;
      lPlayed = '/learningwithwick/practice/games/chapter/1/quiz/';
    }

    for (let child of document.getElementById('last-played').children) {
      if (child.className === 'last-played-button') {
        child.onclick = function () {
          setTimeout(() => {
            location.href = lPlayed;
          }, 250);
        }
      }
    }
  </script>
</body>

</html>